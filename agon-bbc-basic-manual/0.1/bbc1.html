<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>BBC BASIC (Z80) for the Agon light™ :: BBC BASIC (Z80) for the Agon Light</title>
    <link rel="canonical" href="https://oldpatientsea.github.io/agon-bbc-basic-manual/0.1/bbc1.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://oldpatientsea.github.io">BBC BASIC (Z80) for the Agon Light</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="agon-bbc-basic-manual" data-version="0.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">BBC BASIC (Z80) for the Agon Light</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="bbc1.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bbc2.html">General Information</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bbc3.html">Assembler</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bbckey0.html">Statements and Functions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bbckey1.html">ABS-ENVELOPE</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bbckey2.html">EOF#-LOMEM</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bbckey3.html">MID$-PRINT</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bbckey4.html">PRINT#-WIDTH</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="opsys0.html">Operating System Interface</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="opsys1.html">Resident Star Commands</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bbcfile1.html">BBC BASIC (Z80) Disk Files</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bbcfile2.html">Serial Files</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bbcfile3.html">Random (Relative) Files</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bbcfile4.html">Indexed Data Files</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="annexa.html">Table of ASCII Codes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="annexb.html">Mathematical Functions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="annexc.html">Error Messages and Codes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="annexd.html">Format of Program and Variables in Memory</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="copyright.html">Copyrights</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="license.html">License</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">BBC BASIC (Z80) for the Agon Light</span>
    <span class="version">0.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="index.html">BBC BASIC (Z80) for the Agon Light</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">0.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="bbc1.html" class="home-link is-current"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">BBC BASIC (Z80) for the Agon Light</a></li>
    <li><a href="bbc1.html">Introduction</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/oldpatientsea/agon-bbc-basic-manual/edit/main/modules/ROOT/pages/bbc1.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">BBC BASIC (Z80) for the Agon light™</h1>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
When the bird and the book disagree, believe the bird.
</blockquote>
<div class="attribution">
&#8212; John James Audubon<br>
<cite>The Birds of America</cite>
</div>
</div>
<div class="paragraph">
<p>This is an adaptation of R.T. Russell&#8217;s <a href="https://www.bbcbasic.co.uk/bbcbasic/mancpm/index.html">BBC BASIC (Z80) Manual</a> to describe the implementation of BBC BASIC on the Agon light™ and AgonLight 2. It is made with the permission of the original author, using information from <a href="https://github.com/breakintoprogram/agon-docs/wiki/BBC-BASIC-for-Agon">Dean Belfield&#8217;s wiki</a> with his consent.</p>
</div>
<div class="paragraph">
<p>The Agon light™ is an open source, eZ80-based single board computer and microcontroller designed by Bernardo Kastrup. The names "Agon" and "Agon Light" in this manual refer equally to Bernardo&#8217;s original design, his forthcoming Origins collector&#8217;s edition, and to the re-engineered AgonLight 2 by Tsvetan Usunov, owner of Olimex Ltd. All use the same firmware written by Dean Belfield and Jeroen Venema. The names do not refer to a possible Agon 65X which is being designed at the moment by Kyle Cardoza and will, if it is released, have a 6502-series CPU, the W65C265S. BBC BASIC (Z80) requires a Z80 processor. BASIC in this manual, unless otherwise specified, refers to BBC BASIC (Z80) for the Agon light™.</p>
</div>
<div class="paragraph">
<p>The original BBC BASIC (Z80) Manual includes contributions from Doug Mounter who also wrote adaptations for the Z88 and Tatung Einstein. R.T. Russell, Doug Mounter, Dean Belfield, Jeroen Venema, Bernardo Kastrup and Tsvetan Usunov retain any and all original copyrights to and trademarks for their work.</p>
</div>
<div class="paragraph">
<p>This first draft has been collated by Tim Delmare from information shared by the Agon Light community. Any mistakes are mine. When the code and the manual disagree, believe the code.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contributing"><a class="anchor" href="#_contributing"></a>Contributing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This work is licensed under Attribution-ShareAlike 4.0 International. To view a copy of this license, visit <a href="http://creativecommons.org/licenses/by-sa/4.0/" class="bare">http://creativecommons.org/licenses/by-sa/4.0/</a></p>
</div>
<div class="paragraph">
<p>The source for the content of this manual including a history of the alterations from the original sources can be found at <a href="https://github.com/oldpatientsea/agon-bbc-basic-manual" class="bare">https://github.com/oldpatientsea/agon-bbc-basic-manual</a>.</p>
</div>
<div class="paragraph">
<p>The source code for the antora playbook used to generate a web version of the manual is at <a href="https://github.com/oldpatientsea/agon-bbc-basic-manual-playbook" class="bare">https://github.com/oldpatientsea/agon-bbc-basic-manual-playbook</a>.</p>
</div>
<div class="paragraph">
<p>Please feel free to raise issues on GitHub if you have any questions, requests for clarification, have spotted errors or have suggestions for enhancements. All contributions are welcome.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_disclaimer_of_warranty"><a class="anchor" href="#_disclaimer_of_warranty"></a>Disclaimer of Warranty</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Provided as-is, expressly without warranties and/or representations of any kind. The authors disclaim all responsibility for damages incurred as a direct and/or indirect result of the use of this manual and/or the system it describes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_brief_history_of_agon_basic"><a class="anchor" href="#_a_brief_history_of_agon_basic"></a>A Brief History of Agon BASIC</h2>
<div class="sectionbody">
<div class="paragraph">
<p>BASIC (Beginner&#8217;s All-purpose Symbolic Instruction Code) was born in 1964 at Dartmouth College, New Hampshire along with DTSS, the Dartmouth Time Sharing System on which it ran, the work respectively of two brilliant mathematicians, professors John Kemeny and Thomas Kurtz.</p>
</div>
<div class="paragraph">
<p>Immediately popular, the language proliferated and later saw an explosion of different dialects during the home computer boom of the 80s, a period of creativity within tight constraints that retains a particular charm for many. Kemeny and Kurtz were less impressed. "We are greatly concerned that a generation of students is growing up learning Street BASIC, an illiterate dialect of a lovely language."</p>
</div>
<div class="paragraph">
<p>If any BASIC deserved this scorn, one dialect in particular did not: BBC BASIC.</p>
</div>
<div class="paragraph">
<p>The original version of BBC BASIC was written by Sophie Wilson at Acorn in 1981 for the BBC Micro range of computers, and was designed to support the UK Computer Literacy Project. R.T. Russell was involved in the specification of BBC BASIC, and wrote his own Z80 version, BBC BASIC (Z80), that was subsequently ported to a number of Z80 based machines.  <a href="http://www.bbcbasic.co.uk/bbcbasic/history.html">His account</a> is worth reading. Many years later, he made BBC BASIC (Z80) open source under a zlib licence. He still supports BBC Basic, and has ported it for a number of modern platforms, including Android, Windows, and SDL, which are <a href="https://www.bbcbasic.co.uk/index.html">available from his website here</a>.</p>
</div>
<div class="paragraph">
<p>In 2022, Dean Belfield began work on the QUARK firmware for the Agon light™. The firmware consists of three parts: Agon MOS for the eZ80, the CPU driving the machine; Agon VDP for the ESP32-PICO-D4 that handles video and audio as well as managing keyboard input; and, BBC BASIC for Agon, a new port of BBC BASIC (Z80) with a number of modifications to make it run on this specific hardware. The same firmware runs on the AgonLight 2.</p>
</div>
<div class="paragraph">
<p>The current version of BBC BASIC for Agon is 1.04.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_before_you_start"><a class="anchor" href="#_before_you_start"></a>Before You Start</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a reference manual, it is not intended to teach you BASIC. It gives a summary of the BBC BASIC commands and functions plus some hints and tips on their use. A general knowledge of BASIC has been assumed.</p>
</div>
<div class="paragraph">
<p>BBC BASIC (Z80) has been designed to be as compatible as possible with the 6502 BBC BASIC resident in the BBC Microcomputer. The language syntax is not always completely identical to that of the 6502 version, but in most cases the Z80 version is more tolerant.</p>
</div>
<div class="paragraph">
<p>Agon BBC BASIC is comparable with BBC BASIC IV and most simple listings for the BBC Micro can be adapted with a little work, although there are differences in the graphics modes and in the handling of sound.</p>
</div>
<div class="paragraph">
<p>BASIC runs in Z80 mode, that is within a 64K segment. The interpreter takes around 16K of RAM, leaving around 48K available for user programs and data.</p>
</div>
<div class="paragraph">
<p>It needs a full 64K segment, so cannot be run from the MOS folder as a star command.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Those familiar with BBC BASIC on RISC OS may notice some omissions such as the absence of CASE-OF-WHEN-OTHERWISE-ENDCASE in Agon BBC BASIC. The Acorn Archimedes used a 32-bit ARM CPU and removed the 16 KB limit on the BASIC code size, allowing new features to be added in BBC BASIC V which is the version still used in RISC OS. Agon BASIC is still under development and future versions may add some of these missing BBC BASIC V features.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_system_requirements"><a class="anchor" href="#_system_requirements"></a>System Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This manual describes <a href="https://github.com/breakintoprogram/agon-bbc-basic/releases/tag/v1.04">1.04 of Agon BBC BASIC</a>. In order to run this version, you must be using AGON QUARK Firmware 1.03 (MOS 1.03 on Z80 and VDP 1.03 on the ESP32).</p>
</div>
<div class="paragraph">
<p>Where possible, differences between BASIC versions are noted however if you are running an earlier version of the firmware and BASIC you are recommended to follow the <a href="https://github.com/breakintoprogram/agon-docs/wiki/Updating-Firmware">instructions for updating online</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_set_up"><a class="anchor" href="#_set_up"></a>Set Up</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_find_the_appropriate_cables"><a class="anchor" href="#_find_the_appropriate_cables"></a>Find the Appropriate Cables</h3>
<div class="paragraph">
<p>The Agon Light 2 uses VGA for video output and requires a standard VGA cable and, if necessary, adapters to convert that to a signal your monitor can display. The video modes are still a work in progress and you may find that some of them, notably mode 2, do not work especially well on your particular display. If this is the case for you, don’t panic! You are not alone. Work is under way to find a more stable set of video modelines that will work on the widest range of hardware.</p>
</div>
<div class="paragraph">
<p>The Agon Light 2 uses USB-C for power and also for updating VDP, the video component of the firmware.</p>
</div>
<div class="paragraph">
<p>Audio is mono and the output is either via a standard 3.5mm jack or, if you change the headers from their default settings, via an onboard piezo buzzer.</p>
</div>
<div class="paragraph">
<p>The keyboard connection is PS/2 but via a USB connection. Confused? You are not the only one. Many older USB keyboards support the PS/2 protocol and can be used without modification. PS/2 keyboards can also be used with a passive PS/2→USB adapter. For more modern keyboards, if you are handy with a soldering iron, the <a href="https://github.com/No0ne/ps2x2pico">ps2x2pico</a> project uses a Raspberry Pi Pico to convert USB to PS/2. There is a <a href="https://docs.google.com/spreadsheets/d/1-6_sz6l-vJW5rFg3M0Y6bwC0hmFS7U6PPNjIZ9plrM8/edit#gid=0">community maintained spreadsheet of compatible keyboards</a> and using one of these may save you some hair pulling.</p>
</div>
</div>
<div class="sect2">
<h3 id="_prepare_a_microsd_card"><a class="anchor" href="#_prepare_a_microsd_card"></a>Prepare a MicroSD Card</h3>
<div class="paragraph">
<p>The Agon Light uses a microSD card formatted as FAT32. 32GB SDHC microSD cards are recommended.</p>
</div>
<div class="paragraph">
<p>To run BBC BASIC you will need to copy bbcbasic.bin from the appropriate release <a href="https://github.com/breakintoprogram/agon-bbc-basic/releases/tag/v1.04">v1.04 of Agon BBC BASIC</a> as detailed above in System Requirements to the root directory of the microSD card.</p>
</div>
<div class="paragraph">
<p>You may optionally include from the offical Agon BBC BASIC repository the following folders and their contents:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>examples</p>
</li>
<li>
<p>resources</p>
</li>
<li>
<p>tests</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You may wish to create an autoexec.txt file which will be run automatically on startup and is useful, for example, for setting the keyboard locale to your region.</p>
</div>
<div class="paragraph">
<p>The following example file sets your keyboard to US layout, loads bbcbasic, changes to the tests directory then runs basic.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">SET KEYBOARD 1
LOAD bbcbasic.bin
CD tests
RUN</code></pre>
</div>
</div>
<div class="paragraph">
<p>You may also wish to create a directory for applications that can be run as MOS executables called:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>mos</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The file system of your card will now look as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">.
├── autoexec.txt
├── bbcbasic.bin
├── examples/
├── mos/
├── resources/
└── tests/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Insert your card, connect your cables, power on and you’re good to go.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_bbc_basic_z80_for_agon"><a class="anchor" href="#_running_bbc_basic_z80_for_agon"></a>Running BBC BASIC (Z80) for Agon</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To run BBC BASIC (Z80) for Agon, from the MOS prompt type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">&gt;LOAD bbcbasic.bin
&gt;RUN</code></pre>
</div>
</div>
<div class="paragraph">
<p>The system will reply:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">BBC BASIC (Z80) Version 3.00
(C) Copyright R.T.Russell 1987</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
MOS automatically runs the contents of the AUTOEXEC.TXT file found in the root directory of your microSD card. If you have created the default AUTOEXEC.TXT file shown in the example above when setting up your device, then it will include the commands above and therefore your Agon Light will appear to boot directly to BASIC without you needed to type anything.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is possible to automatically CHAIN (load and run) a BBC BASIC program by passing the filename as a parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">LOAD bbcbasic.bin
RUN . /path/to/file.bas</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Passing a <code>.</code> as the first parameter of RUN is informing MOS to use the default value there (&amp;40000).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To exit BBC BASIC (Z80) and return to MOS type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">&gt;*BYE</code></pre>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
